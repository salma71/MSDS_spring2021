knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(xts)
library(DMwR2)
library(quantmod)
library(TTR)
library(performanceEstimation)
library(nnet)
library(e1071)
library(kernlab)
library(earth)
library(randomForest)
library(ggplot2)
library(dplyr)
library(plotly)
library(hrbrthemes)
library(readr)
dataset <- read_csv('https://raw.githubusercontent.com/salma71/Data_621/master/Project_Proposal/stocks_combined.csv')
tickers <- read_csv('https://raw.githubusercontent.com/salma71/Data_621/master/Project_Proposal/tickers.csv')
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
T.ind <- function(quotes,tgt.margin=0.025,n.days=10) {
v <- apply(HLC(quotes),1,mean) # function HLC() extracts the High, Low, and Close quotes
v[1] <- Cl(quotes)[1]
r <- matrix(NA,ncol=n.days,nrow=NROW(quotes))
for(x in 1:n.days) r[,x] <- Next(Delt(v,k=x),x)
x <- apply(r,1,function(x)
sum(x[x > tgt.margin | x < -tgt.margin]))
if (is.xts(quotes)) xts(x,time(quotes)) else x
}
ts <- xts(aapl[,-1], order.by = as.Date(anytime::anydate(aapl$date)))
avgPrice <- function(p) apply(HLC(p), 1, mean)
addAvgPrice <- newTA(FUN=avgPrice, col=1, legend='AvgPrice')
addT.ind <- newTA(FUN=T.ind, col='red', legend='tgtRet')
candleChart(last(ts,'3 months'), theme='white', TA=c(addAvgPrice(on=1), addT.ind()))
last(ts)
last(ts, '3 months')
last(ts, '3 weeks')
avgPrice <- function(p) apply(HLC(p), 1, mean)
addAvgPrice <- newTA(FUN=avgPrice, col=1, legend='AvgPrice')
addT.ind <- newTA(FUN=T.ind, col='red', legend='tgtRet')
candleChart(xts::last(ts,'3 months'), theme='white', TA=c(addAvgPrice(on=1), addT.ind()))
xts::last(ts, '3 months')
str(xts)
str(ts)
storage.mode(ts) <- "numeric"
ts <- na.locf(ts)
ts
str(ts)
library(readr)
dataset <- read_csv('https://raw.githubusercontent.com/salma71/Data_621/master/Project_Proposal/stocks_combined.csv')
tickers <- read_csv('https://raw.githubusercontent.com/salma71/Data_621/master/Project_Proposal/tickers.csv')
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
str(aapl)
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
as.xts()
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
as.Date(anytime:anydate(date)) %>%
dplyr::select(-date) %>%
as.numeric() %>%
as.xts(order.by = date)
ataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
as.Date(anytime:anydate(date))
dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
as.Date(anytime:anydate(date))
temp = dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
temp$date = as.Date(anytime::anydate(temp$date))
head(temp)
temp %>% dplyr::select(-date)
temp %>% as.xts(order.by = date)
temp
s = as.xts(temp)
s = as.xts(temp[,-1], order.by = temp$date)
s
s %>% dplyr::select(-date, -ticker) %>% as.numeric()
dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
as.Date.POSIXct()
temp = dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
t = as.Date.ts(temp)
t = as.Date.POSIXct(temp)
t = as.Date.POSIXct(temp$date)
t = as.Date.ts(temp$date)
t
t = temp
t$date = as.Date.POSIXct(t$date)
t$date = as.Date.ts(t$date)
head(t)
t$date = as.Date.POSIXct(t$date)
head(t)
t = ttemp
t = temp
t$date = as.Date(t$date)
t$date = as.Date.character(t$date)
t$date = as.Date.numeric()
t$date = as.Date.numeric(t$date)
t$date = anytime::anydate(t$date)
gead(t)
head(t)
as.xts(t)
as.xts([,-1])
as.xts(t[,-1])
as.xts(t[,1])
str(t)
tt = xts::xts(order.by = t$date)
head(tt)
tt = xts::xts(t, order.by = t$date)
head(tt)
tt = xts::xts(t[,-1], order.by = t$date)
head(tt)
last(tt, '3 months')
xts::last(tt, '3 months')
is.xts(tt)
candleChart(xts::last(ts,'3 months'))
candleChart(xts::last(tt,'3 months'))
lty <- c("dotted", "solid")
plot(tt$close, lty = lty, legend.loc = "left")
plot(tt, lty = lty, legend.loc = "left")
plot(as.numeric(tt$close), lty = lty, legend.loc = "left")
avgPrice <- function(p) apply(HLC(as.numeric(p)), 1, mean)
addAvgPrice <- newTA(FUN=avgPrice, col=1, legend='AvgPrice')
addT.ind <- newTA(FUN=T.ind, col='red', legend='tgtRet')
candleChart(xts::last(ts,'3 months'), theme='white', TA=c(addAvgPrice(on=1), addT.ind()))
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
anytime:anydate(date) %>%
as.xts(order.by = date)
library(anytime)
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
anytime:anydate(date) %>%
as.xts(order.by = date)
library(anytime)
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL") %>%
anytime:anydate(date)
library(anytime)
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
library(anytime)
aapl <- dataset %>%
dplyr::select(date, ticker, open, close, volume) %>%
dplyr::filter(ticker == "AAPL")
aapl$date <- anytime::anydate(aapl$date)
head(aapl)
# convert to xts time series
aapl_xts <- xts::xts(aapl[, -1], order.by = aapl$date)
head(aapl_xts)
avgPrice <- function(p) apply(HLC(as.numeric(p)), 1, mean)
addAvgPrice <- newTA(FUN=avgPrice, col=1, legend='AvgPrice')
addT.ind <- newTA(FUN=T.ind, col='red', legend='tgtRet')
candleChart(xts::last(aapl_xts,'3 months'), theme='white', TA=c(addAvgPrice(on=1), addT.ind()))
# convert to xts time series
aapl_xts <- xts::xts(aapl[, -1], order.by = aapl$date)
aapl_xts$open <- as.character.numeric_version(aapl_xts$open)
head(aapl_xts)
is.xts(aapl_xts)
library(corrplot)
library(RColorBrewer)
M <-cor(aapl)
library(corrplot)
library(RColorBrewer)
M <-cor(aapl[, -1])
library(corrplot)
library(RColorBrewer)
M <-cor(aapl[, c(-1, -2)])
corrplot(M, type="upper", order="hclust",
col=brewer.pal(n=8, name="RdYlBu"))
library(corrplot)
library(RColorBrewer)
M <-cor(dataset[, c(-1, -2)])
library(corrplot)
library(RColorBrewer)
M <-cor(dataset[, c(-1, -2, -12)])
corrplot(M, type="upper", order="hclust",
col=brewer.pal(n=8, name="RdYlBu"))
setwd("~/Desktop/MSDS_spring2021/data_624")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(forecast)
library(tidyverse)
library(readr)
library(fpp2)
theme_set(theme_classic())
autoplot(gold) +
ggtitle('Gold prices: forecast package')
autoplot(woolyrnq) +
ggtitle('Woolyrnq prices: forecast package') +
xlab("Time") +
ylab("Woolyrnq")
autoplot(gas) +
ggtitle('Gas prices: forecast package')
print(paste0('The frequency in gold dataset is: ', frequency(gold)))
print(paste0('The frequency in woolyrnq dataset is: ', frequency(woolyrnq)))
print(paste0('The frequency in gas dataset is: ', frequency(gas)))
print(paste0('The observation that is considered outlier is: ', which.max(gold)))
print(paste0('The gold price on that observation was: ', gold[which.max(gold)]))
# if(!file.exists("tute1.csv")){
#   download.file("https://otexts.com/fpp2/extrafiles/tute1.csv", "tute1.csv")
# }
tute1 <- readr::read_csv("tute1.csv")
View(tute1)
mytimeseries <- ts(tute1[,-1], start=1981, frequency=4)
autoplot(mytimeseries, facets=TRUE)
autoplot(mytimeseries)
library(readxl)
# if(!file.exists("retail.xlsx")){
#   download.file("https://otexts.com/fpp2/extrafiles/retail.xlsx", "retail.xlsx")
# }
retaildata <- readxl::read_excel("retail.xlsx", skip=1)
myts <- ts(retaildata[,"A3349873A"], frequency=12, start=c(1982,4))
autoplot(myts)
ggseasonplot(myts, polar = TRUE)
ggsubseriesplot(myts)
gglagplot(myts)
ggAcf(myts, lag.max = 75)
autoplot(hsales)
ggseasonplot(hsales, polar = TRUE)
ggsubseriesplot(hsales)
gglagplot(hsales)
ggAcf(hsales, lag.max = 70)
autoplot(usdeaths)
ggseasonplot(usdeaths, polar = TRUE)
ggsubseriesplot(usdeaths)
gglagplot(usdeaths)
ggAcf(usdeaths, lag.max = 70)
autoplot(bricksq)
ggseasonplot(bricksq, polar = TRUE)
ggsubseriesplot(bricksq)
gglagplot(bricksq)
ggAcf(bricksq, lag.max = 70)
autoplot(sunspotarea)
# ggseasonplot(sunspotarea)
# ggsubseriesplot(sunspotarea)
gglagplot(sunspotarea)
ggAcf(sunspotarea, lag.max = 70)
autoplot(gasoline)
ggseasonplot(gasoline, polar = TRUE)
# ggsubseriesplot(gasoline)
gglagplot(gasoline)
ggAcf(gasoline, lag.max = 70)
